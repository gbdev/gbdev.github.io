<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.66">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png"><meta property="og:site_name" content="gbdev.io"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@gbdev0"><meta name="og:image" content="https://gbdev.io/images/gbinternals.png"><title>Adding a custom SGB border | gbdev.io</title><meta name="description" content="game boy development scene">
    <link rel="preload" href="/assets/style-d912344a.css" as="style"><link rel="stylesheet" href="/assets/style-d912344a.css">
    <link rel="modulepreload" href="/assets/app-9169927d.js"><link rel="modulepreload" href="/assets/sgb_border.html-2f2e1bb0.js"><link rel="modulepreload" href="/assets/sgb_border.html-bc8bc6ba.js"><link rel="prefetch" href="/assets/index.html-73be7817.js" as="script"><link rel="prefetch" href="/assets/chat.html-ea257c93.js" as="script"><link rel="prefetch" href="/assets/contribute.html-40aa85d7.js" as="script"><link rel="prefetch" href="/assets/gbcompo21.html-99aaee71.js" as="script"><link rel="prefetch" href="/assets/gbcompo23.html-e8ce819f.js" as="script"><link rel="prefetch" href="/assets/resources.html-6f26efe6.js" as="script"><link rel="prefetch" href="/assets/results.html-702e5c99.js" as="script"><link rel="prefetch" href="/assets/asmstyle.html-f84bdcf1.js" as="script"><link rel="prefetch" href="/assets/deadcscroll.html-cf90a12f.js" as="script"><link rel="prefetch" href="/assets/dma_hijacking.html-3c0726e8.js" as="script"><link rel="prefetch" href="/assets/lyc_timing.html-7f10ac5d.js" as="script"><link rel="prefetch" href="/assets/tools.html-e21b5d86.js" as="script"><link rel="prefetch" href="/assets/404.html-60b35caa.js" as="script"><link rel="prefetch" href="/assets/index.html-1aef8c56.js" as="script"><link rel="prefetch" href="/assets/chat.html-f4ed1679.js" as="script"><link rel="prefetch" href="/assets/contribute.html-c81ec524.js" as="script"><link rel="prefetch" href="/assets/gbcompo21.html-23794e7a.js" as="script"><link rel="prefetch" href="/assets/gbcompo23.html-2a504684.js" as="script"><link rel="prefetch" href="/assets/resources.html-a78832dc.js" as="script"><link rel="prefetch" href="/assets/results.html-e5f0cc50.js" as="script"><link rel="prefetch" href="/assets/asmstyle.html-01104793.js" as="script"><link rel="prefetch" href="/assets/deadcscroll.html-e3e1aa3f.js" as="script"><link rel="prefetch" href="/assets/dma_hijacking.html-458aef51.js" as="script"><link rel="prefetch" href="/assets/lyc_timing.html-aa792186.js" as="script"><link rel="prefetch" href="/assets/tools.html-c67e4336.js" as="script"><link rel="prefetch" href="/assets/404.html-214a3716.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><!----><span class="site-name">gbdev.io</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/gbcompo23" class="" aria-label="GB Compo 2023"><!--[--><!--]--> GB Compo 2023 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://hh.gbdev.io" rel="noopener noreferrer" target="_blank" aria-label="Games"><!--[--><!--]--> Games <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://gbdev.io/pandocs" rel="noopener noreferrer" target="_blank" aria-label="Pan Docs"><!--[--><!--]--> Pan Docs <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Community"><span class="title">Community</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Community"><span class="title">Community</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/chat" class="" aria-label="Chat"><!--[--><!--]--> Chat <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/contribute" class="" aria-label="Contribute"><!--[--><!--]--> Contribute <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/gbcompo21" class="" aria-label="GB Competition 2021"><!--[--><!--]--> GB Competition 2021 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a href="/resources" class="" aria-label="Resources"><!--[--><!--]--> Resources <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Guides"><span class="title">Guides</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Guides"><span class="title">Guides</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/guides/tools" class="" aria-label="Choosing development tools"><!--[--><!--]--> Choosing development tools <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guides/asmstyle" class="" aria-label="ASM Style recomendations"><!--[--><!--]--> ASM Style recomendations <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guides/lyc_timing" class="" aria-label="The Timing of LYC STAT Handlers"><!--[--><!--]--> The Timing of LYC STAT Handlers <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guides/deadcscroll" class="" aria-label="Dead C Scroll"><!--[--><!--]--> Dead C Scroll <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://eldred.fr/blog/2022/05/22/prehistorik" rel="noopener noreferrer" target="_blank" aria-label="The wonders of Prehistorik Man"><!--[--><!--]--> The wonders of Prehistorik Man <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guides/dma_hijacking" class="" aria-label="DMA Hijacking"><!--[--><!--]--> DMA Hijacking <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guides/sgb_border" class="router-link-active" aria-label="Adding a custom SGB border"><!--[--><!--]--> Adding a custom SGB border <!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/gbcompo23" class="" aria-label="GB Compo 2023"><!--[--><!--]--> GB Compo 2023 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://hh.gbdev.io" rel="noopener noreferrer" target="_blank" aria-label="Games"><!--[--><!--]--> Games <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://gbdev.io/pandocs" rel="noopener noreferrer" target="_blank" aria-label="Pan Docs"><!--[--><!--]--> Pan Docs <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Community"><span class="title">Community</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Community"><span class="title">Community</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/chat" class="" aria-label="Chat"><!--[--><!--]--> Chat <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/contribute" class="" aria-label="Contribute"><!--[--><!--]--> Contribute <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/gbcompo21" class="" aria-label="GB Competition 2021"><!--[--><!--]--> GB Competition 2021 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a href="/resources" class="" aria-label="Resources"><!--[--><!--]--> Resources <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Guides"><span class="title">Guides</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Guides"><span class="title">Guides</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/guides/tools" class="" aria-label="Choosing development tools"><!--[--><!--]--> Choosing development tools <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guides/asmstyle" class="" aria-label="ASM Style recomendations"><!--[--><!--]--> ASM Style recomendations <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guides/lyc_timing" class="" aria-label="The Timing of LYC STAT Handlers"><!--[--><!--]--> The Timing of LYC STAT Handlers <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guides/deadcscroll" class="" aria-label="Dead C Scroll"><!--[--><!--]--> Dead C Scroll <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://eldred.fr/blog/2022/05/22/prehistorik" rel="noopener noreferrer" target="_blank" aria-label="The wonders of Prehistorik Man"><!--[--><!--]--> The wonders of Prehistorik Man <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guides/dma_hijacking" class="" aria-label="DMA Hijacking"><!--[--><!--]--> DMA Hijacking <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guides/sgb_border" class="router-link-active" aria-label="Adding a custom SGB border"><!--[--><!--]--> Adding a custom SGB border <!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">Adding a custom SGB border <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/guides/sgb_border.html#enabling-sgb-features" class="router-link-active router-link-exact-active sidebar-item" aria-label="Enabling SGB features"><!--[--><!--]--> Enabling SGB features <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guides/sgb_border.html#packets" class="router-link-active router-link-exact-active sidebar-item" aria-label="Packets"><!--[--><!--]--> Packets <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guides/sgb_border.html#trn" class="router-link-active router-link-exact-active sidebar-item" aria-label="TRN"><!--[--><!--]--> TRN <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guides/sgb_border.html#detecting-sgb" class="router-link-active router-link-exact-active sidebar-item" aria-label="Detecting SGB"><!--[--><!--]--> Detecting SGB <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/guides/sgb_border.html#sgb-detection-notes" class="router-link-active router-link-exact-active sidebar-item" aria-label="SGB detection notes"><!--[--><!--]--> SGB detection notes <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/guides/sgb_border.html#border-limitations" class="router-link-active router-link-exact-active sidebar-item" aria-label="Border limitations"><!--[--><!--]--> Border limitations <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guides/sgb_border.html#converting-borders" class="router-link-active router-link-exact-active sidebar-item" aria-label="Converting borders"><!--[--><!--]--> Converting borders <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guides/sgb_border.html#uploading-borders" class="router-link-active router-link-exact-active sidebar-item" aria-label="Uploading borders"><!--[--><!--]--> Uploading borders <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guides/sgb_border.html#notes" class="router-link-active router-link-exact-active sidebar-item" aria-label="Notes"><!--[--><!--]--> Notes <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="adding-a-custom-sgb-border" tabindex="-1"><a class="header-anchor" href="#adding-a-custom-sgb-border" aria-hidden="true">#</a> Adding a custom SGB border</h1><p>This document aims to help developers of DMG-compatible homebrew with adding Super Game Boy borders.</p><p>We will see how to:</p><ul><li>Detect whether we are running on a SGB</li><li>Transfer the border&#39;s tiles</li><li>Transfer and display the border&#39;s tilemap and palettes</li></ul><small><p>Written by <a href="https://zlago.github.io/me/" target="_blank" rel="noopener noreferrer">sylvie (zlago)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, idea (and minor help) by <a href="https://coffeebat.neocities.org/" target="_blank" rel="noopener noreferrer">valentina (coffee bat)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, reviews and improvements by <a href="https://eldred.fr" target="_blank" rel="noopener noreferrer">ISSOtm<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> and <a href="https://github.com/avivace" target="_blank" rel="noopener noreferrer">avivace<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p></small><h2 id="enabling-sgb-features" tabindex="-1"><a class="header-anchor" href="#enabling-sgb-features" aria-hidden="true">#</a> Enabling SGB features</h2><p>Before we can do anything else, we must first specify in the header that this game is aware of SGB features. Otherwise, the SGB BIOS will ignore any packets we send, and we won&#39;t even be able to detect when the program is running on SGB.</p><p>To enable SGB features:</p><ul><li>The <a href="https://gbdev.io/pandocs/The_Cartridge_Header#0146--sgb-flag" target="_blank" rel="noopener noreferrer">SGB flag<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> must be set to <code>$03</code>;</li><li>The <a href="https://gbdev.io/pandocs/The_Cartridge_Header#014b--old-licensee-code" target="_blank" rel="noopener noreferrer">old licensee code<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> must be set to <code>$33</code>.</li></ul><p>This can be achieved by passing the <code>--sgb-compatible</code> and <code>--old-licensee 0x33</code> flags to <a href="https://rgbds.gbdev.io/docs/rgbfix.1" target="_blank" rel="noopener noreferrer"><code>rgbfix</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p><h2 id="packets" tabindex="-1"><a class="header-anchor" href="#packets" aria-hidden="true">#</a> Packets</h2><p>The SGB BIOS can be &quot;talked to&quot; via <em>command packets</em>, sent bit by bit via the <code>P1</code>/<code>JOYP</code> register.</p><p>An SGB packet consists of:</p><ul><li>a &quot;start&quot; pulse (<code>P1</code>=<code>%xx00xxxx</code>)</li><li>128 data pulses (<code>P1</code>=<code>%xx01xxxx</code> for &quot;1&quot;, <code>P1</code>=<code>%xx10xxxx</code> for &quot;0&quot;)</li><li>a &quot;0&quot; pulse (<code>P1</code>=<code>%xx10xxxx</code>)</li></ul><p>You must set <code>P1</code> to <code>%xx11xxxx</code> between each pulse.</p><p>This adds up to 16 Bytes of data (LSB first), If a packet doesn&#39;t read all 16 bytes, the unused bytes are ignored.</p><p><strong>You should wait 4 frames between each packet.</strong></p><p>For an example of such routine, see this <a href="https://github.com/zlago/violence-gbc/blob/11cfdb6ee8a35e042fa9712484d814e0961cea7c/src/sub.sm83#L413-L463" target="_blank" rel="noopener noreferrer">code<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> and the related Pan Docs entry: <a href="https://gbdev.io/pandocs/SGB_Command_Packet.html" target="_blank" rel="noopener noreferrer">SGB Command Packet on Pandocs<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p><p>This guide glosses over a minor detail, as certain packets can be (albeit unccomon) more than 16 bytes.</p><h2 id="trn" tabindex="-1"><a class="header-anchor" href="#trn" aria-hidden="true">#</a> TRN</h2><p>Bulk transfer (TRN) packets tell the SGB to copy the contents of the screen to buffers in Super NES work RAM. The <code>CHR_TRN</code> and <code>PCT_TRN</code> packets are used to send data for SGB borders.</p><p>For that to function properly, you must:</p><ol><li>set <code>BGP</code> to <code>$e4</code> and <code>LCDC</code> to <code>$91</code> (screen enabled, BG uses tiles <code>$8000</code>-<code>$8fff</code> and tilemap <code>$9800</code>, WIN and OBJ disabled, BG enabled)</li><li>set <code>SCX</code> and <code>SCY</code> to <code>$00</code></li><li>the tilemap consists of <code>$00</code>, <code>$01</code>..<code>$13</code>, 12 bytes padding (offscreen), <code>$14</code>..<code>$27</code>, padding, repeat until <code>$ff</code> (inclusive)</li><li>the data you want to send must be loaded at <code>$8000</code>-<code>$8fff</code></li></ol><p>You can do 1, 2 and 3 via <a href="https://github.com/zlago/snek-gbc/blob/baef0369f57d2b0d58316cb1c28c6cc22475a6c9/code/init.sm83#L208-L230" target="_blank" rel="noopener noreferrer">this snippet<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><ul><li><strong>You must load the data into VRAM and enable the screen before sending the TRN packet</strong></li><li><strong>You must wait ~8 frames after each TRN</strong> instead of just 4</li></ul><h2 id="detecting-sgb" tabindex="-1"><a class="header-anchor" href="#detecting-sgb" aria-hidden="true">#</a> Detecting SGB</h2><p>Here&#39;s how a SGB detection routine should look like:</p><ul><li>wait 12 or more frames after the console boots</li><li>send a <code>MLT_REQ</code>, selecting 2 or 4 players (<code>$89, $01</code> or <code>$89, $03</code>), and wait at least 1 frame</li><li>attempt to advance the read player (set <code>P1.5</code> to 0 then 1)</li><li>set <code>P1.4</code>-<code>P1.5</code> to <code>%11</code> (<code>%xx11xxxx</code>)</li><li>read <code>P1.0</code>-<code>P1.3</code>, and check if it either <ul><li>has changed</li><li>isn&#39;t <code>%1111</code></li></ul></li><li>advance and reread a few times and branch somewhere if the test keeps failing</li></ul><p>Let&#39;s go over an example snippet (<a href="https://github.com/zlago/snek-gbc/blob/baef0369f57d2b0d58316cb1c28c6cc22475a6c9/code/init.sm83#L167-L196" target="_blank" rel="noopener noreferrer">source<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>):</p><div class="language-sm83asm line-numbers-mode" data-ext="sm83asm"><pre class="language-sm83asm"><code>; test for SGB
xor a /* first it enables STAT interrupt, since snek-gbc happens to just have a `reti` as the handler */
ldh [rLYC], a
ld a, STATF_LYC
ldh [rSTAT], a
ld a, IEF_STAT
ldh [rIE], a
ei
	; wait for SGB
	ld b, 12 /* You must wait 12 or more frames before trying to send a packet */
	:halt
	dec b
	jr nz, :-
	; enable multi
	ld hl, Packets.mlt /* send a `MLT_REQ` */
	call Packet
	rept 4 /* then wait 4 more frames, since the SNES won&#39;t &quot;read&quot; the packet instantly */
		halt
	endr
	; check if SGB responds
		/* and now We actually try to detect the SGB
		setting `P1.5` to low then high advances the &quot;read player&quot;
		setting `P1.4` and `P1.5` high will make the SGB return which player is currently selected in `P1.0` and `P1.1` */
		lb bc, 5, LOW(rP1) /* b is loaded with 5 which is how many times We try to check if the player changes to anything but P1 */
		:ld a, P1F_4 /* try to advance player */
		ldh [c], a
		ld a, P1F_4|P1F_5 /* then set P1 to return the current player */
		ldh [c], a
		ldh a, [c]
		dec b
		jp z, .init ; give up /* if 5 (4 actually) attempts fail, assume this isn&#39;t an SGB */
		cp $ff /* `P1.6` and `P1.7` always return %1, We set `P1.4` and `P1.5` to %1, and DMG, or SGB player 1, return %1111 in `P1.0`-`P1.3` */
		jr z, :- ; /* try again if detection fails */
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>If you adopt this, remember to change <code>.init</code> to wherever code should jump to if it&#39;s <em>not</em> on SGB, and put code meant to run on SGB after the snippet.</p><h3 id="sgb-detection-notes" tabindex="-1"><a class="header-anchor" href="#sgb-detection-notes" aria-hidden="true">#</a> SGB detection notes</h3><ul><li><p>It would be a good idea to save somewhere in RAM whether the game is running on an SGB capable device or not, such that if you wish to change the border mid-gameplay, you won&#39;t have to perform SGB detection again</p></li><li><p><strong>If you wish to only use 1 controller for the game, you will have to send another <code>MLT_REQ</code> to disable multiplayer</strong> (<code>$89, $00</code>)</p></li><li><p>You can change the waitloop to not use interrupts, or to use di+halt instead</p></li></ul><h2 id="border-limitations" tabindex="-1"><a class="header-anchor" href="#border-limitations" aria-hidden="true">#</a> Border limitations</h2><p>An SGB border has:</p><ul><li>255 tiles + 1 transparent tile (preferably tile #0)</li><li>3 palettes of 15 (+ 1 transparent) colors, (up to 45 solid colors total)</li><li>a 256x224px tilemap (there&#39;s a bit more to this, see <a href="#notes">notes</a>)</li></ul><h2 id="converting-borders" tabindex="-1"><a class="header-anchor" href="#converting-borders" aria-hidden="true">#</a> Converting borders</h2><p>With a recent version of <a href="https://github.com/Optiroc/SuperFamiconv" target="_blank" rel="noopener noreferrer">superfamiconv<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>:</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>superfamiconv <span class="token parameter variable">-v</span> <span class="token parameter variable">-i</span> input.png <span class="token parameter variable">-p</span> output.pal <span class="token parameter variable">-t</span> output.4bpp <span class="token parameter variable">-P</span> <span class="token number">4</span> <span class="token parameter variable">-m</span> output.pct <span class="token parameter variable">-M</span> snes --color-zero 0000ff <span class="token parameter variable">-B</span> <span class="token number">4</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><code>--color-zero</code> should be the color that your image for transparency, in my case it was blue. <ul><li>If your image has an alpha channel, it can be set can also be set to <code>00000000</code> to use the actual transparent color; however, this may cause some issues.</li></ul></li><li><code>-v</code> is optional, for showing details of the conversion process</li><li>You can add a row of the transparent color at the top of the image to force superfamiconv to make it tile #0, then <code>incbin &quot;output.pct&quot;, 64</code> to leave out that row.</li><li><code>-P 4</code> sets the base palette to the 4th one, and <strong>SGB borders use SNES palettes 4, 5, and 6.</strong> as of writing this, this option only works if you built superfamiconv from source.</li></ul><h2 id="uploading-borders" tabindex="-1"><a class="header-anchor" href="#uploading-borders" aria-hidden="true">#</a> Uploading borders</h2><p>As stated before, the SGB border consists of tile data, picture data, and palette data. These are split across 2-3 packets:</p><ul><li><p><code>CHR_TRN</code> (<code>$99</code>) is used to send 4KiB of tile data.</p><ul><li>since the border can use up to 8KiB of tiles, bit 0 of the second byte specifies which &quot;half&quot; you&#39;re sending <ul><li><code>$99, $00</code> if the screen is loaded with the first 4KiB of tile data</li><li><code>$99, $01</code> if the screen is loaded with the second 4KiB of tile data</li></ul></li></ul></li><li><p><code>PCT_TRN</code> (<code>$a1</code>) is used to send the picture and palette data. it also swaps the border, generally a good idea to send it after the tile data[^1]</p><ul><li>assuming tiles <code>0</code>-<code>255</code> use VRAM from <code>$8000</code> to <code>$8fff</code>: <ul><li>the picture data must be at <code>$8000</code>-<code>$873f</code> (last 64 bytes are <em>usually</em> offscreen, see <a href="#notes">notes</a>)</li><li>palette data must be at <code>$8800</code>-<code>$885f</code></li><li>everything else is ignored <ul><li>how you skip putting data at <code>$8740</code>-<code>$87ff</code> is up to you, I prefer doing separate copies, valen prefers copying tilemap and palette data in one go, with the area between them pa</li></ul></li></ul></li></ul></li></ul><p>See also the related Pan Docs entry: <a href="https://gbdev.io/pandocs/SGB_Command_Border.html" target="_blank" rel="noopener noreferrer">SGB Command Border<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p><p>[^1]: You can send a <code>CHR_TRN</code> <a href="https://github.com/pinobatch/little-things-gb/blob/b11b554d73c48a0f54fee0df31e59eb83806fcb4/sgbears/docs/long_story.md" target="_blank" rel="noopener noreferrer">up to ~60 frames<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> after the <code>PCT_TRN</code> for it to apply to the current border, but not all emulators will emulate this. It&#39;s fine to just pretend <code>CHR_TRN</code>s must go before <code>PCT_TRN</code>.</p><h2 id="notes" tabindex="-1"><a class="header-anchor" href="#notes" aria-hidden="true">#</a> Notes</h2><ol><li><p>You can set the first row of tiles to your transparent color to force superfamiconv to put the transparent tile as the 1st tile, however you must then exclude 64 bytes of the tilemap (<code>incbin &quot;border.pct&quot;</code> -&gt; <code>incbin &quot;border.pct&quot;, 64</code>)</p></li><li><p>You can use palettes 0-3 and 7, if you really know what you&#39;re doing (animated borders yay). You will probably have to edit the border in YY-CHR, as there aren&#39;t really any other tools for that.</p></li><li><p>When the SNES lags, scanline 225 of the SGB border will be visible! You can set the topmost row of the 29th row of tiles to black to hide this.</p></li><li><p>If this doesn&#39;t work for you, you can ask for help on the <a href="https://gbdev.io/chat.html" target="_blank" rel="noopener noreferrer">gbdev<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> channels.</p></li></ol></div><!--[--><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/gbdev/gbdev.github.io/edit/dev/website/guides/sgb_border.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page"><!--[--><!--]--> Edit this page <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!----><!----></footer><!----><!--[--><!--[--><div class="my-footer"><hr><a href="/contribute.html">Sponsors </a><br><a href="https://www.digitalocean.com/" target="_blank"><img class="sponsor_logo" src="/assets/DO_Powered_by_Badge_blue-db29a947.svg"></a><a href="https://incube8games.com/" target="_blank" alt="Incube8 Games - Physical Retro Gaming Publisher"><img alt="Incube8 Games - Physical Retro Gaming Publisher" class="sponsor_logo incube8" src="/assets/Incube8-Games-Logo-7ab96810.png"></a></div><!--]--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app-9169927d.js" defer></script>
  </body>
</html>
